<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Efficiency Planner Tool</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css" />

    <!-- SmartWizard CSS -->
    <link
      rel="stylesheet"
      href="./assets/libs/jquery-smartwizard-master/dist/css/smart_wizard_all.min.css"
    />
    <style>
      .suggestions {
        border: 1px solid #ccc;
        max-height: 100px;
        overflow-y: auto;
        display: none;
        position: absolute;
        background: white;
        z-index: 10;
        width: 33.33333333%;
      }
      .suggestion-item {
        padding: 10px 5px;
        cursor: pointer;
      }
      .suggestion-item:hover {
        background: #f0f0f0;
      }

      .image-preview {
        width: 100%;
        height: 300px;
        background-color: #f0f0f0;
        border: 1px dashed #ccc;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
      }

      .image-preview img,
      .image-preview iframe {
        max-width: 100%;
        max-height: 100%;
      }
    </style>
  </head>

  <body>
    <header class="py-3 mb-4 border-bottom bg-success-subtle">
      <div class="container d-flex flex-wrap justify-content-center">
        <a
          href="../index.html"
          class="d-flex align-items-center h-3 text-success mb-3 mb-lg-0 me-lg-auto text-dark text-decoration-none"
        >
          Mimi & Marble Tech Limited
        </a>
      </div>
    </header>

    <div class="container mt-4">
      <div class="row">
        <div class="col-md-12">
          <div id="smartwizard">
            <ul class="nav">
              <li class="nav-item">
                <a class="nav-link" href="#address">Address</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#requirements">Requirements</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#options">Options</a>
              </li>
            </ul>

            <div class="tab-content" style="">
              <!-- Step 1: EPC Verification -->
              <div
                id="address"
                class="tab-pane"
                role="tabpanel"
                aria-labelledby="address"
              >
                <form id="search_postcode_form" class="my-3 col-4 m-auto">
                  <input
                    type="search"
                    class="form-control"
                    id="postalCode"
                    placeholder="Enter Postcode to begin..."
                    aria-label="Search"
                  />
                  <div class="suggestions" id="suggestionsContainer"></div>
                  <button class="btn btn-outline-secondary my-2 w-100">
                    Search
                  </button>
                </form>
                <div class="row">
                  <form id="epc_verification_form" class="d-none">
                    <div class="display-6 text-center mb-4">
                      Verify Property Details
                    </div>

                    <div class="row g-3">
                      <!-- Current EPC Certificate -->
                      <div class="col-md-4 d-none">
                        <label for="epcCertificate" class="form-label"
                          >Current EPC Certificate or Estimated EPC</label
                        >
                      </div>
                      <div class="col-md-8 d-none">
                        <input
                          type="text"
                          class="form-control"
                          id="epcCertificate"
                          placeholder="Enter EPC Certificate details"
                        />
                      </div>

                      <!-- Type of House -->
                      <div class="col-md-4">
                        <label for="houseType" class="form-label"
                          >Type of House</label
                        >
                      </div>
                      <div class="col-md-8">
                        <select class="form-select" id="houseType" disabled>
                          <option selected>Select type of house</option>
                          <option value="detached">Detached</option>
                          <option value="semi-detached" selected>
                            Semi-Detached
                          </option>
                          <option value="terraced">Terraced</option>
                          <option value="flat">Flat</option>
                        </select>
                      </div>

                      <!-- Estimated House Value -->
                      <div class="col-md-4">
                        <label for="houseValue" class="form-label"
                          >Estimated House Value (£)</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="number"
                          class="form-control"
                          id="houseValue"
                          placeholder="Enter estimated value"
                          value="650000"
                          disabled
                        />
                      </div>

                      <!-- Council Tax Band -->
                      <div class="col-md-4">
                        <label for="councilTax" class="form-label"
                          >Council Tax Band</label
                        >
                      </div>
                      <div class="col-md-8">
                        <select class="form-select" id="councilTax" disabled>
                          <option selected>Select council tax band</option>
                          <option value="A">A</option>
                          <option value="B">B</option>
                          <option value="C">C</option>
                          <option value="D">D</option>
                          <option value="E" selected>E</option>
                          <option value="F">F</option>
                          <option value="G">G</option>
                          <option value="H">H</option>
                        </select>
                      </div>

                      <!-- Age of House -->
                      <div class="col-md-4">
                        <label for="houseAge" class="form-label"
                          >Age of House (Years)</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="number"
                          class="form-control"
                          id="houseAge"
                          placeholder="Enter age of house"
                          value="85"
                          disabled
                        />
                      </div>

                      <!-- Number of Bedrooms -->
                      <div class="col-md-4">
                        <label for="bedrooms" class="form-label"
                          >Number of Bedrooms</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="number"
                          class="form-control"
                          id="bedrooms"
                          placeholder="Enter number of bedrooms"
                          value="3"
                          disabled
                        />
                      </div>

                      <!-- Wall Type -->
                      <div class="col-md-4">
                        <label for="wallType" class="form-label"
                          >Wall Type</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="text"
                          class="form-control"
                          id="wallType"
                          placeholder="Enter wall type"
                          value="Brick"
                          disabled
                        />
                      </div>

                      <!-- Roof Type -->
                      <div class="col-md-4">
                        <label for="roofType" class="form-label"
                          >Roof Type</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="text"
                          class="form-control"
                          id="roofType"
                          placeholder="Enter roof type"
                          value="Pitched"
                          disabled
                        />
                      </div>

                      <!-- Window Type -->
                      <div class="col-md-4">
                        <label for="windowType" class="form-label"
                          >Window Type</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="text"
                          class="form-control"
                          id="windowType"
                          placeholder="Enter window type"
                          value="No data available"
                          disabled
                        />
                      </div>

                      <!-- Main Heating Source -->
                      <div class="col-md-4">
                        <label for="heatingSource" class="form-label"
                          >Main Heating Source</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="text"
                          class="form-control"
                          id="heatingSource"
                          placeholder="Enter heating source"
                          value="Boiler and radiators, mains gas"
                          disabled
                        />
                      </div>

                      <!-- Solar Panels -->
                      <div class="col-md-4">
                        <label for="solarPanels" class="form-label"
                          >Solar Panels (Yes/No)</label
                        >
                      </div>
                      <div class="col-md-8">
                        <select class="form-select" id="solarPanels" disabled>
                          <option selected>Select option</option>
                          <option value="yes">Yes</option>
                          <option value="no" selected>No</option>
                        </select>
                      </div>

                      <!-- Estimated Average Energy Costs -->
                      <div class="col-md-4">
                        <label for="energyCosts" class="form-label"
                          >Estimated Average Energy Costs (£)</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="number"
                          class="form-control"
                          id="energyCosts"
                          placeholder="Enter average energy costs"
                          value="207"
                          disabled
                        />
                      </div>

                      <!-- Estimated Carbon Emissions -->
                      <div class="col-md-4">
                        <label for="carbonEmissions" class="form-label"
                          >Estimated Carbon Emissions (kgCO2)</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="text"
                          class="form-control"
                          id="carbonEmissions"
                          placeholder="Enter carbon emissions"
                          value="No data available"
                          disabled
                        />
                      </div>

                      <!-- Property Orientation -->
                      <div class="col-md-4">
                        <label for="propertyOrientation" class="form-label"
                          >Property Orientation</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="text"
                          class="form-control"
                          id="propertyOrientation"
                          placeholder="Enter property orientation"
                          value="North West"
                          disabled
                        />
                      </div>

                      <!-- Property Structure -->
                      <div class="col-md-4">
                        <label for="propertyStructure" class="form-label"
                          >Property Structure</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="text"
                          class="form-control"
                          id="propertyStructure"
                          placeholder="Enter property structure"
                          value="327.91"
                          disabled
                        />
                      </div>

                      <!-- Roof Area -->
                      <div class="col-md-4">
                        <label for="roofArea" class="form-label"
                          >Roof Area (m<sup>2</sup>)</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="number"
                          class="form-control"
                          id="roofArea"
                          placeholder="Enter roof area"
                          value="47"
                          disabled
                        />
                      </div>

                      <!-- Roof Pitch -->
                      <div class="col-md-4">
                        <label for="roofPitch" class="form-label"
                          >Roof Pitch (degrees)</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          type="number"
                          class="form-control"
                          id="roofPitch"
                          placeholder="Enter roof pitch"
                          value="38"
                          disabled
                        />
                      </div>

                      <!-- Aerial View Image -->
                      <div class="col-md-4">
                        <label for="aerialImage" class="form-label"
                          >Aerial View Image</label
                        >
                      </div>
                      <div class="col-md-8">
                        <input
                          class="form-control"
                          type="file"
                          id="aerialImage"
                          accept="image/*"
                          onchange="previewImage(event, 'aerialPreviewImg')"
                        />
                        <!-- Aerial View Image Preview -->
                        <div class="image-preview mt-3" id="aerialPreview">
                          <img
                            id="aerialPreviewImg"
                            src="assets/image/aerial-view.png"
                            alt="aerial-view"
                            class="img-fluid"
                            style="max-height: 300px"
                          />
                        </div>
                      </div>

                      <div class="col-md-4">
                        <label for="streetImage" class="form-label"
                          >Street View Image</label
                        >
                      </div>
                      <div class="col-md-8">
                        <!-- Image Input -->
                        <input
                          class="form-control"
                          type="file"
                          id="streetImage"
                          accept="image/*"
                          onchange="previewImage(event,'streetPreviewImg')"
                        />
                        <!-- Image Preview -->
                        <div class="image-preview mt-3" id="streetPreview">
                          <img
                            id="streetPreviewImg"
                            src="assets/image/street-view.png"
                            alt="street-view"
                            class="img-fluid"
                            style="max-height: 300px"
                          />
                        </div>
                      </div>
                    </div>
                    <div class="row mt-2 g-3">
                      <div class="col-md-8"></div>
                      <div class="col-md-4 text-end">
                        <button
                          type="button"
                          class="btn btn-primary"
                          id="validateAddressModal"
                          data-bs-toggle="modal"
                          data-bs-target="#validationModal"
                        >
                          Confirm Property Details
                        </button>
                        <button
                          type="button"
                          class="btn btn-success"
                          id="saveAddress"
                          style="display: none"
                        >
                          Save and Next
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>

              <!-- Step 2: Requirements -->
              <div
                id="requirements"
                class="tab-pane"
                role="tabpanel"
                aria-labelledby="requirements"
              >
                <div class="display-6 text-center mb-2">
                  Update energy demand
                </div>
                <form action="" class="" id="requirementForm">
                  <!-- Electric Car Section -->
                  <div class="row mt-3 g-3">
                    <div class="mb-3 row">
                      <label class="col-md-6 col-form-label"
                        >Do you have or plan to purchase an electric car?</label
                      >
                      <div class="col-md-6 d-flex align-items-center">
                        <div class="form-check me-3">
                          <input
                            class="form-check-input"
                            type="radio"
                            name="electricCar"
                            id="electricCarYes"
                          />
                          <label class="form-check-label" for="electricCarYes"
                            >Yes</label
                          >
                        </div>
                        <div class="form-check">
                          <input
                            class="form-check-input"
                            type="radio"
                            name="electricCar"
                            id="electricCarNo"
                          />
                          <label class="form-check-label" for="electricCarNo"
                            >No</label
                          >
                        </div>
                      </div>
                    </div>

                    <div id="evChargerSection" class="mb-3 row d-none">
                      <label class="col-md-6 col-form-label"
                        >Do you have an EV Charger?</label
                      >
                      <div class="col-md-6 d-flex align-items-center">
                        <div class="form-check me-3">
                          <input
                            class="form-check-input"
                            type="radio"
                            name="evCharger"
                            id="evChargerYes"
                          />
                          <label class="form-check-label" for="evChargerYes"
                            >Yes</label
                          >
                        </div>
                        <div class="form-check">
                          <input
                            class="form-check-input"
                            type="radio"
                            name="evCharger"
                            id="evChargerNo"
                          />
                          <label class="form-check-label" for="evChargerNo"
                            >No</label
                          >
                        </div>
                      </div>
                    </div>

                    <div class="mb-3 row">
                      <label class="col-md-6 col-form-label"
                        >Do you have room in the loft or roof?</label
                      >
                      <div class="col-md-6 d-flex align-items-center">
                        <div class="form-check me-3">
                          <input
                            class="form-check-input"
                            type="radio"
                            name="loftSpace"
                            id="loftSpaceYes"
                          />
                          <label class="form-check-label" for="loftSpaceYes"
                            >Yes</label
                          >
                        </div>
                        <div class="form-check">
                          <input
                            class="form-check-input"
                            type="radio"
                            name="loftSpace"
                            id="loftSpaceNo"
                          />
                          <label class="form-check-label" for="loftSpaceNo"
                            >No</label
                          >
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>

              <!-- Step 3: Options -->
              <div
                id="options"
                class="tab-pane"
                role="tabpanel"
                aria-labelledby="options"
              >
                <div class="row">
                  <h1 class="text-center">Energy Efficiency Plans</h1>
                  <div class="row my-4">
                    <!-- Card 1: Low Cost Quick Wins -->
                    <div class="col-6">
                      <div class="card" id="low-cost-form-card">
                        <div class="card-header">Low Cost Quick Wins</div>
                        <div class="card-body">
                          <form id="low-cost-form">
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="30"
                                id="draftProofing"
                              />
                              <label
                                class="form-check-label"
                                for="draftProofing"
                              >
                                Window and Door Draft Proofing (£30)
                              </label>
                            </div>
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="10"
                                id="lowEnergyBulbs"
                              />
                              <label
                                class="form-check-label"
                                for="lowEnergyBulbs"
                              >
                                Low-energy Light Bulbs (£10)
                              </label>
                            </div>
                            <p class="mt-3">
                              Total: £<span id="lowCostTotal">0</span>
                            </p>
                          </form>
                        </div>
                      </div>
                    </div>

                    <!-- Card 2: Budget-Friendly Energy Efficiency Solutions -->
                    <div class="col-6">
                      <div class="card" id="budget-friendly-form-card">
                        <div class="card-header">
                          Budget-Friendly Energy Efficiency Solutions
                        </div>
                        <div class="card-body">
                          <form id="budget-friendly-form">
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="100"
                                id="loftInsulation"
                              />
                              <label
                                class="form-check-label"
                                for="loftInsulation"
                              >
                                Loft Insulation (£100)
                              </label>
                            </div>
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="120"
                                id="cavityWallInsulation"
                              />
                              <label
                                class="form-check-label"
                                for="cavityWallInsulation"
                              >
                                Cavity Wall Insulation (£120)
                              </label>
                            </div>
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="50"
                                id="ventilation"
                              />
                              <label class="form-check-label" for="ventilation">
                                Ventilation (£50)
                              </label>
                            </div>
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="300"
                                id="evCharger"
                              />
                              <label class="form-check-label" for="evCharger">
                                EV Charger (£300)
                              </label>
                            </div>
                            <p class="mt-3">
                              Total: £<span id="budgetFriendlyTotal">0</span>
                            </p>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- Row 2 -->

                  <div class="row my-4">
                    <div class="col-12">
                      <div class="card" id="higher-cost-form-card">
                        <div class="card-header">
                          Higher-Cost Longer-Term Solutions
                        </div>
                        <div class="card-body">
                          <form id="higher-cost-form">
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="4000"
                                id="solar"
                              />
                              <label class="form-check-label" for="solar">
                                Solar (£4000)
                              </label>
                            </div>
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="6000"
                                id="solarBattery"
                              />
                              <label
                                class="form-check-label"
                                for="solarBattery"
                              >
                                Solar + Battery (£6000)
                              </label>
                            </div>
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="8000"
                                id="heatPump"
                              />
                              <label class="form-check-label" for="heatPump">
                                Air Source or Ground Source Heat Pump (£8000)
                              </label>
                            </div>
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="3000"
                                id="doubleGlazing"
                              />
                              <label
                                class="form-check-label"
                                for="doubleGlazing"
                              >
                                New Double Glazing (£3000)
                              </label>
                            </div>
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="5000"
                                id="externalWallInsulation"
                              />
                              <label
                                class="form-check-label"
                                for="externalWallInsulation"
                              >
                                External Wall Insulation (£5000)
                              </label>
                            </div>
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="checkbox"
                                value="4000"
                                id="internalWallInsulation"
                              />
                              <label
                                class="form-check-label"
                                for="internalWallInsulation"
                              >
                                Internal Wall Insulation (£4000)
                              </label>
                            </div>
                            <p class="mt-3">
                              Total: £<span id="higherCostTotal">0</span>
                            </p>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Address Validation Modal Structure -->
    <div
      class="modal fade"
      id="validationModal"
      tabindex="-1"
      aria-labelledby="validationModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="validationModalLabel">
              Validate Property Details
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>Please confirm if the property details are correct.</p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-success"
              id="confirmAddressValidation"
            >
              Confirm property details are correct
            </button>
            <button
              type="button"
              class="btn btn-warning"
              id="updateAddressValidation"
            >
              Edit Property Details
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="../assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

    <!-- jQuery and SmartWizard JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- <script src="../assets/libs/jquery/dist/jquery.min.js"></script> -->
    <script src="../assets/libs/simplebar/dist/simplebar.js"></script>

    <script src="./assets/libs/jquery-smartwizard-master/dist/js/jquery.smartWizard.min.js"></script>

    <!-- Initialize SmartWizard -->
    <script>
      $(document).ready(function () {
        const dummyAddresses = [
          "33, Langham Gardens, Wembley, HA0 3RG",
          "221B Baker Street, Marylebone, London NW1 6XE",
        ];

        let isAddressValid = false;
        let currentPackageOption = "";

        $("#smartwizard").smartWizard({
          selected: 0,
          theme: "arrows",
          transition: {
            animation: "fade",
          },
          disabledSteps: [1, 2],
        });

        /* Disable step 2 and 3 until step 1 is validated */
        $("#smartwizard").smartWizard("stepState", [1, 2], "disable");
        $(".sw-btn-next").prop("disabled", true);

        /* Address Step */

        $("#smartwizard").on(
          "showStep",
          function (e, anchorObject, stepIndex, stepDirection, stepPosition) {
            if (stepIndex == 0 && isAddressValid) {
              updateWizardState(true, 0);
            }
          }
        );

        $("#confirmAddressValidation").on("click", function (e) {
          e.preventDefault();
          isAddressValid = true;
          $(".sw-btn-next").prop("disabled", false);
          $("#smartwizard").smartWizard("stepState", [0], "done");
          $("#smartwizard").smartWizard("unsetState", [1], "disable");
          $("#validateAddressModal").toggle("d-none");
          $("#validationModal").modal("hide");
        });

        $("#updateAddressValidation").on("click", function (e) {
          isAddressValid = true;
          $("#epc_verification_form input").prop("disabled", false);
          $("#epc_verification_form select").prop("disabled", false);
          $("#validateAddressModal").toggle("d-none");
          $("#saveAddress").toggle("d-none");
          $("#validationModal").modal("hide");
          updateWizard();
        });

        $("#saveAddress").on("click", function (e) {
          e.preventDefault();
          updateWizardState(true, 0);
          $("#smartwizard").smartWizard("next");
        });

        /* Postcode search */
        $("#search_postcode_form").on("submit", function (e) {
          e.preventDefault();
          $("#epc_verification_form").toggleClass("d-none");
          $("#search_postcode_form").toggleClass("d-none");
          updateWizard();
        });

        /* Dummy suggestion search input */
        $("#postalCode").on("input", function () {
          const input = $(this).val();
          const suggestionsContainer = $("#suggestionsContainer");

          suggestionsContainer.empty();

          if (input) {
            suggestionsContainer.show();

            dummyAddresses.forEach((address) => {
              const suggestionItem = $(
                '<div class="suggestion-item"></div>'
              ).text(address);
              suggestionItem.on("click", function () {
                selectAddress(address);
              });
              suggestionsContainer.append(suggestionItem);
            });
          } else {
            suggestionsContainer.hide();
          }
        });

        function selectAddress(address) {
          $("#postalCode").val(address);
          $("#suggestionsContainer").hide();
        }

        $(document).on("click", function (event) {
          if (!$(event.target).closest("#postalCode").length) {
            $("#suggestionsContainer").hide();
          }
        });

        /* Requirement */
        $('input[name="electricCar"]').change(function () {
          if ($("#electricCarYes").is(":checked")) {
            $("#evChargerSection").removeClass("d-none");
          } else {
            $("#evChargerSection").addClass("d-none");
            $('input[name="evCharger"]').prop("checked", false);
          }
          updateWizard();
        });
        $('#requirementForm input[type="radio"]').on("change", function () {
          checkRequirementFormCompletion();
        });

        /* Options */
        $('#options input[type="checkbox"]').on("change", function () {
          const currentForm = $(this).closest("form");
          const currentFormName = currentForm.attr("id");
          console.log(currentFormName);
          if (currentPackageOption != currentFormName) {
            currentPackageOption = currentFormName;
            $("#options form")
              .not(currentForm)
              .each(function () {
                $(this).find('input[type="checkbox"]').prop("checked", false);
              });
            $("#options").find(".card").css("border", "");
            $("#" + currentFormName + "-card").css("border", "2px solid red");
          }
          updateTotal("low-cost-form", "lowCostTotal");
          updateTotal("budget-friendly-form", "budgetFriendlyTotal");
          updateTotal("higher-cost-form", "higherCostTotal");
        });
      });

      function updateWizard() {
        $("#smartwizard").smartWizard("fixHeight");
      }

      function checkRequirementFormCompletion() {
        const electricCarSelected =
          $('input[name="electricCar"]:checked').length > 0;
        const evChargerSelected =
          ($("#electricCarYes").is(":checked") &&
            $('input[name="evCharger"]:checked').length > 0) ||
          $("#electricCarNo").is(":checked");
        const loftSpaceSelected =
          $('input[name="loftSpace"]:checked').length > 0;
        if (electricCarSelected && evChargerSelected && loftSpaceSelected) {
          updateWizardState(true, 1);
        } else {
          updateWizardState(false, 1);
        }
      }

      function updateWizardState(nextStatus, currentStep) {
        if (nextStatus) {
          $(".sw-btn-next").prop("disabled", false);
          $(".sw-btn-next").removeClass("disabled");
          $("#smartwizard").smartWizard("stepState", [currentStep], "done");
          $("#smartwizard").smartWizard(
            "unsetState",
            [currentStep + 1],
            "disable"
          );
        } else {
          $(".sw-btn-next").prop("disabled", true);
          $("#smartwizard").smartWizard("unsetState", [currentStep], "done");
          $("#smartwizard").smartWizard(
            "stepState",
            [currentStep + 1],
            "disable"
          );
        }
      }

      function previewImage(event, previewId) {
        const reader = new FileReader();
        const previewImg = document.getElementById(previewId);

        reader.onload = function () {
          if (reader.readyState === 2) {
            previewImg.src = reader.result;
          }
        };

        reader.readAsDataURL(event.target.files[0]);
      }

      function updateTotal(formId, totalId) {
        let total = 0;

        $(`#${formId} input[type="checkbox"]`).each(function () {
          if ($(this).is(":checked")) {
            total += parseInt($(this).val());
          }
        });

        $(`#${totalId}`).text(total);
      }
    </script>
  </body>
</html>
